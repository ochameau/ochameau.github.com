<!DOCTYPE html>
<html>
<head><title>Web Kaleidoscope tutorial</title></head>
<body>
<h3>Works only with Firefox 4 Beta 6 or nightlies!</h3>
<style>
body {
  text-align: center;
}
#source {
  -moz-transition: -moz-transform 10s linear;
}
.source-sized {
  width: 640px;
  height: 360px;
}
.source-sized.absolute {
  position: absolute;
  top: 0; left: 0;
}
.source-sized.container {
  margin: auto;
  position: relative;
}
.show-box {
  background: black;
  -moz-box-shadow: 1px 1px 10px #00f;
  -moz-border-radius: 5px;
  border: 1px solid black;
  margin:auto;
  width: 640px;
  height: 360px;
  overflow: hidden;
}
pre.code {
  text-align: left;
  background: silver;
  border: 1px solid black;
  border-left: 15px solid gray;
  padding: 5px 10px;
  font-size: 12px;
}
</style>

<p class="description">
  First we take an image like this one :
</p>

<div class="show-box">
  <img id="source" class="source-sized" src="kaleidoscope-source.jpg" />
</div>

<pre class="code">
&lt;img id=&quot;source&quot; class=&quot;source-sized&quot; src=&quot;image-flickr.jpg&quot; /&gt;
</pre>

<hr />

<p class="description">
  Then we clip it as a tiny triangle with SVG clippath and polygon element 
  (and -moz-element to firstly duplicate the element) : 
</p>

<svg height="0" xmlns="http://www.w3.org/2000/svg">
  <clipPath id="triangle-clip" clipPathUnits="objectBoundingBox" transform="translate(0,0)">
    <polygon points="0.25,0.24 0.5,0.5 0.15,0.5" />
  </clipPath>
</svg>
<div class="show-box">
  <div id="triangle" class="source-sized" style="background: -moz-element(#source); clip-path: url(#triangle-clip); margin: auto;"></div>
</div>

<pre class="code">
&lt;svg height=&quot;0&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;
  &lt;clipPath id=&quot;clip&quot; clipPathUnits=&quot;objectBoundingBox&quot; transform=&quot;translate(0,0)&quot;&gt;
    &lt;polygon id=&quot;triangle&quot; points=&quot;0.25,0.2425 0.5,0.5 0.15,0.5&quot; /&gt;
  &lt;/clipPath&gt;
&lt;/svg&gt;
&lt;div id=&quot;triangle&quot; class=&quot;source-sized&quot; style=&quot;background: -moz-element(#source); clip-path: url(#clip); margin: auto;&quot;&gt;&lt;/div&gt;
</pre>

<hr />

<p class="description">
  After we create a duplicate mirror of this triangle with CSS transform property (and -moz-element):
</p>

<div class="show-box">
  <div id="triangle-invert" class="source-sized" style="background: -moz-element(#triangle); -moz-transform: scaleY(-1); margin: auto;"></div>
</div>

<pre class="code">
&lt;div id=&quot;triangle-invert&quot; class=&quot;source-sized&quot; style=&quot;background: -moz-element(#triangle); -moz-transform: scaleY(-1); margin: auto;&quot;&gt;&lt;/div&gt;
</pre>

<hr />

<p class="description">
  We may so combine these two triangles to obtain one quarter of our kaleidoscope, using one more time -moz-element CSS:
</p>

<div class="show-box">
  <div id="quarter" class="source-sized container">
    <div class="source-sized absolute" style="background: -moz-element(#triangle);"></div>
    <div class="source-sized absolute" style="background: -moz-element(#triangle-invert);"></div>
  </div>
</div>

<pre class="code">
&lt;div id=&quot;quarter&quot; class=&quot;source-sized container&quot;&gt;
  &lt;div class=&quot;source-sized absolute&quot; style=&quot;background: -moz-element(#triangle);&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;source-sized absolute&quot; style=&quot;background: -moz-element(#triangle-invert);&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
</pre>

  
<hr />

<a name="final" />
<p class="description">
  Finally we duplicate this quarter 6 times to obtain a full kaleidoscope, by duplicating it with -moz-element and rotating it with CSS transform property:
</p>

<div class="show-box">
  <div class="source-sized container" style="background: black; border: 15px solid black;">
    <div class="source-sized absolute" style="background: -moz-element(#quarter);"></div>
    <div class="source-sized absolute" style="background: -moz-element(#quarter);  -moz-transform: rotate(60deg);"></div>
    <div class="source-sized absolute" style="background: -moz-element(#quarter);  -moz-transform: rotate(120deg);"></div>
    <div class="source-sized absolute" style="background: -moz-element(#quarter);  -moz-transform: rotate(180deg);"></div>
    <div class="source-sized absolute" style="background: -moz-element(#quarter);  -moz-transform: rotate(240deg);"></div>
    <div class="source-sized absolute" style="background: -moz-element(#quarter);  -moz-transform: rotate(300deg);"></div>
  </div>
</div>

<pre class="code">
&lt;div class=&quot;source-sized container&quot; style=&quot;background: black; border: 20px solid black;&quot;&gt;
  &lt;div class=&quot;source-sized absolute&quot; style=&quot;background: -moz-element(#quarter);&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;source-sized absolute&quot; style=&quot;background: -moz-element(#quarter);  -moz-transform: rotate(60deg);&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;source-sized absolute&quot; style=&quot;background: -moz-element(#quarter);  -moz-transform: rotate(120deg);&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;source-sized absolute&quot; style=&quot;background: -moz-element(#quarter);  -moz-transform: rotate(180deg);&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;source-sized absolute&quot; style=&quot;background: -moz-element(#quarter);  -moz-transform: rotate(240deg);&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;source-sized absolute&quot; style=&quot;background: -moz-element(#quarter);  -moz-transform: rotate(300deg);&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
</pre>

<hr />

<p class="description">
  And the final touch is to launch one CSS animation combined with a CSS transformation, in order to rotate source image!
</p>

<script>
  var i = 1;
  function launchAnimation() {
    var source = document.getElementById("source");
    source.style.MozTransform = "rotate("+(i++*360)+"deg)";
    window.setTimeout(launchAnimation,10000);
  }
</script>
<a href="#final" onclick="launchAnimation()">Launch the rotation!</a>

<pre class="code">
&lt;script&gt;
  var i = 1;
  function launchAnimation() {
    var source = document.getElementById(&quot;source&quot;);
    source.style.MozTransform = &quot;rotate(&quot;+(i++*360)+&quot;deg)&quot;;
    window.setTimeout(launchAnimation,10000);
  }
&lt;/script&gt;
&lt;a href=&quot;#final&quot; onclick=&quot;launchAnimation()&quot;&gt;Launch the rotation!&lt;/a&gt;
</pre>

  
</body>
</html>